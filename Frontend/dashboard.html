<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <link rel="icon" href="images/logo.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <!--responsive-meta-end-->
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/fontawesome.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/responsive.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="css/owl.carousel.min.css" media="screen" />
    <link rel="stylesheet" href="css/style.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <title>Dashboard</title>
    <style>
        /* GLOBAL */
        
        li {
            list-style-type: none;
        }
        
        a {
            text-decoration: none;
        }
        
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        input[type=number] {
            -moz-appearance: textfield;
        }
        
        .header {
            position: fixed;
            background: #0f1224;
            border-bottom: 1px solid #272d51;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            z-index: 2;
        }
        
        .left-zone {
            display: flex;
            align-items: center;
        }
        
        #toggle {
            cursor: pointer;
        }
        
        .qr-box {
            margin: auto;
            width: 200px;
        }
        
        #toggle.on .one {
            -webkit-transform: rotate(-45deg) translate(-5px, 5px);
            -moz-transform: rotate(-45deg) translate(-5px, 5px);
            -ms-transform: rotate(-45deg) translate(-5px, 5px);
            -o-transform: rotate(-45deg) translate(-5px, 5px);
            transform: rotate(-45deg) translate(-4px, 4px);
        }
        
        #toggle.on .two {
            opacity: 0;
        }
        
        #toggle.on .three {
            -webkit-transform: rotate(45deg) translate(-6px, -7px);
            -moz-transform: rotate(45deg) translate(-6px, -7px);
            -ms-transform: rotate(45deg) translate(-6px, -7px);
            -o-transform: rotate(45deg) translate(-6px, -7px);
            transform: rotate(45deg) translate(-6px, -6px);
        }
        
        .logo a {
            padding-left: 10px;
            font-size: 24px;
            font-weight: 500;
            color: white;
            line-height: 50px !important;
            margin: 0 0 0 25px;
        }
        
        #toggle .bar {
            -webkit-transition: all 0.3s;
            -moz-transition: all 0.3s;
            -ms-transition: all 0.3s;
            -o-transition: all 0.3s;
            transition: all 0.3s;
            display: block;
            width: 20px;
            height: 3px;
            margin: 4px 0;
            background-color: white;
        }
        
        .search-input {
            width: 100%;
            max-width: 350px;
            margin-left: 20px;
            margin-right: 20px;
        }
        
        .search-input .search {
            width: 100%;
            height: 30px;
        }
        
        .right-zone {
            display: flex;
            align-items: center;
        }
        
        .right-zone .notification i {
            font-size: 25px;
            color: white;
            padding-right: 20px;
        }
        
        .right-zone .user-avatar .user-img {
            width: 50px;
            border-radius: 50%;
        }
        
        #side-nav {
            width: 270px;
            height: 100%;
            overflow-y: scroll;
            display: flex;
            background: #0f1224;
            border-right: 1px solid #272d51;
            flex-direction: column;
            position: fixed;
            top: 0;
            /*transition: all .5s;*/
            margin-top: 80px;
            z-index: 1;
        }
        
        #side-nav.active {
            width: 65px;
            /*transition: all .5s;*/
        }
        
        #side-nav::-webkit-scrollbar {
            width: 10px;
        }
        
        #side-nav::-webkit-scrollbar-thumb {
            background: red;
        }
        
        #side-nav .active .nav-list span {
            display: none;
        }
        
        .nav-list .nav-link {
            display: flex;
            align-items: center;
            color: #7a7e97;
            border-radius: 10px !important;
            font-size: 14px;
            padding: 12px;
        }
        
        .nav-list .nav-link:hover {
            background: #272734;
        }
        
        .nav-list .nav-link span {
            /*animation: navLinksFade .8s forwards;*/
            margin-left: 00px;
            font-family: "Semibold";
            font-size: 14px;
        }
        
        .nav-list {
            padding: 20px 10px 20px 20px;
        }
        
        #contentbox {
            /*height: 100%;*/
            display: block !important;
            width: 100%;
            flex-direction: column;
            top: 0;
            float: right;
            margin: auto;
            transition: all .5s;
            margin-top: 70px;
            margin-left: 250px;
            padding: 25px;
        }
        
        .active #contentbox {
            width: 100%;
            height: 100%;
            flex-direction: column;
            top: 0;
            transition: all .5s;
            margin-top: 70px;
            margin-left: 80px;
            padding: 25px;
        }
        
        .nav_left_tab {
            padding: 0;
        }
        
        .nav_left_tab li {
            width: 100%;
            margin-bottom: 8px;
        }
        
        .nav_left_tab li a {
            border-radius: 0 !important;
        }
        
        .nav-pills .nav-link.active,
        .nav-pills .show>.nav-link {
            background: #019EE2 !important;
            color: #fff;
        }
        
        .tab-pane {
            margin-left: 275px;
            margin-top: 20px;
            transition: .6s;
        }
        
        .content_container {
            max-width: 821px;
            padding-left: 32px;
            padding-right: 32px;
            margin: auto;
        }
        
        .active .tab-pane {
            margin-left: 75px;
            margin-top: 20px;
            transition: .6s;
        }
        
        div#innertab2 .tab-pane {
            margin: 40px 0 !important;
        }
        
        ul#inneourtmenutb {
            border: 0;
            display: flex;
            -webkit-box-pack: center;
            justify-content: center;
            -webkit-box-align: center;
            align-items: center;
        }
        
        #inneourtmenutb .nav-link.active {
            color: #ffffff;
            background-color: #272734;
            border-color: 0;
            font-weight: 600;
            margin: 0 8px;
            border: 1px solid #00000052;
            border-radius: 20px;
            /* background: transparent; */
            padding: 6px 16px;
        }
        
        ul#inneourtmenutb .nav-link {
            border: 0px solid transparent;
            color: #000000;
            background-color: #ffffff;
            border: 1px solid #2929294f;
            border-radius: 20px;
            margin: 0 8px;
            padding: 6px 16px;
            font-weight: 600;
        }
        
        ul#inneourtmenutb .nav-link:focus,
        ul#inneourtmenutb .nav-link:hover {
            border-color: unset;
        }
        
        @media screen and (min-device-width: 200px) and (max-device-width: 960px) {
            #side-nav.active {
                width: 100%;
                /*transition: all .5s;*/
            }
            .active .tab-pane {
                margin-left: 0;
                margin-top: 50px;
                transition: .6s;
            }
            .tab-pane {
                margin-left: 0px;
                margin-top: 50px;
                transition: .6s;
            }
            #side-nav {
                width: 0;
            }
        }
        
        @media screen and (min-device-width: 200px) and (max-device-width: 600px) {
            .content_container {
                padding-left: 25px;
                padding-right: 25px;
            }
        }
        
        #side-nav li a i {
            width: 30px;
            font-size: 16px;
        }
        
        .dataTable tbody tr {
            background-color: transparent !important;
        }
        
        .table td,
        .table th {
            border-top: 0px !important;
            ;
        }
        
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter,
        .dataTables_wrapper .dataTables_info,
        .dataTables_wrapper .dataTables_processing,
        .dataTables_wrapper .dataTables_paginate {
            color: #fff !important;
        }
        
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled,
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:hover,
        .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:active {
            color: #fff !important;
        }
        
        .table-hover tbody tr:hover {
            color: #019ee2 !important;
        }
        
        .table-site .dataTables_wrapper .dataTables_paginate .paginate_button {
            color: #fff !important;
        }
        
        .ajax-loader {
            z-index: 999999;
            display: flex;
            align-items: center;
            width: 100%;
            height: 100%;
            background-color: #000000ad;
            justify-content: center;
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }
        
        .dashboard_field {
            width: 83%;
            margin-right: 5px;
            border-radius: 10px;
            background: #151a33;
            border: 1px solid #3b4166;
            color: white;
            padding: 0 15px;
        }
    </style>
    <script>
        window.pauseCheck;
        async function paused() {
            settings = {
                "url": "https://puno.finance:5000/api/getPause",
                "method": 'GET',
                "contentType": "application/json",
                "data": '',
                "dataType": 'json',
            };
            $.ajax(settings).done(function(response) {
                if (response.data == true) {
                    window.pauseCheck = true;
                } else {
                    window.pauseCheck = false;
                }
            });
        }
        paused();

        function login_check() {
            let user_id = localStorage.getItem('userid');
            if (user_id || tronWeb.defaultAddress.base58) {
                return;
            } else {
                window.location.replace("https://puno.finance");
            }
        }
        login_check();

        var data;

        function callFun() {
            let userId = localStorage.getItem('userid');
            console.log("userId", userId);
            if (userId != null) {
                let settings = api(`api/show_user?user_id=${userId}`, 'GET', '');
                $.ajax(settings).done(function(response) {

                    data = response;
                    let number = data.data[0].phoneNumber;
                    let email = data.data[0].email;
                    let username = data.data[0].username;
                    console.log(number, email);
                    document.getElementById('EmailID').value = email;
                    document.getElementById('username').value = username;
                    document.getElementById("current_password").value = "";
                    document.getElementById("username").readOnly = "readonly";
                    document.getElementById("EmailID").readOnly = "readonly";
                    if (number == 0) {} else {
                        document.getElementById('phoenNumber').value = number;
                        document.getElementById('phone_ver').style.display = 'block'
                        document.getElementById('verifyNumber').style.display = 'none';
                        document.getElementById('mobilehide').style.display = 'none';
                        document.getElementById("phoenNumber").readOnly = "readonly";
                        document.getElementById('numchange').style.display = 'block';
                    }
                });
            }
        }

        var otpNumber;

        function numChange() {
            document.getElementById('phoenNumber').removeAttribute('readonly');
            document.getElementById('numchange').style.display = 'none';
            document.getElementById('phone_ver').style.display = 'none';
            document.getElementById('verifyNumber').style.display = 'block';
            document.getElementById('mobilehide').style.display = 'block';
        }

        function verifyNumber() {
            // console.log(otpNumber);
            if (document.getElementById('phoenNumber').value == '') {
                document.getElementById('phone_error').innerHTML = '*Please fill this filed';
                document.getElementById('phone_error').style.display = 'block';
                return 0;
            } else {
                if (((document.getElementById('phoenNumber').value).length) == 10) {

                } else {
                    document.getElementById('phone_error').style.display = 'block';
                    document.getElementById('phone_error').innerHTML = '*Phone number is wrong';
                    console.log('return else')
                    return 0;
                }
            }
            console.log('hgjgj')
            document.getElementById('phone_error').style.display = 'none';
            document.getElementById('otp_phoneID').style.display = 'block';
            let phone = document.getElementById('phoenNumber').value;
            // document.getElementById('verifyNumber').style.display = "none";
            var settings = {
                "url": "https://puno.finance:5000/api/phone_otp",
                "method": "POST",
                "timeout": 0,
                "processData": false,
                "mimeType": "multipart/form-data",
                "contentType": false,
                "data": {
                    "phone": phone
                },
            };

            $.ajax(settings).done(function(response) {
                console.log("sms", response);
                let res = JSON.parse(response);
                otpNumber = res.otp;
                document.getElementById('verifyNumber').style.display = 'none';
                //  console.log('response',res);	

            });
        }
        var test;

        function verify(next) {
            if (document.getElementById('otp_phone').value != '') {
                if (document.getElementById('otp_phone').value == otpNumber) {
                    document.getElementById('otp_phoneID').style.display = 'none';
                    $('.ajax-loader').css("display", "flex");
                    next();
                    // swal("Verified", { buttons: false, icon: "success", timer: 1000 });	
                } else {
                    swal("Wrong OTP", {
                        buttons: false,
                        icon: "warning",
                        timer: 3000
                    });
                    document.getElementById('verifyNumber').style.display = 'block';
                }
            } else {
                swal("Enter OTP", {
                    buttons: false,
                    icon: "warning",
                    timer: 3000
                });
            }

        }

        function updateNumber() {
            let phone = document.getElementById('phoenNumber').value;
            let userId = user_id;
            console.log(phone, userId)
            var settings = {
                "url": "https://puno.finance:5000/api/updateNumber",
                "method": "POST",
                "timeout": 0,
                "headers": {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                "data": {
                    "userID": userId,
                    "phone": phone
                }
            };

            $.ajax(settings).done(function(response) {
                console.log(response);
                if (response.success == true) {
                    $('.ajax-loader').css("display", "none");
                    document.getElementById('phone_ver').style.display = 'block';
                    document.getElementById("phoenNumber").readOnly = "readonly";
                    document.getElementById('numchange').style.display = 'block';
                    document.getElementById('verifyNumber').style.display = "none";
                    document.getElementById('mobilehide').style.display = "none";
                    swal("Phone number updated successfully", {
                        button: false,
                        icon: "success",
                        timer: 3000
                    });
                }
            });

        }
    </script>
</head>

<body>
    <div class="ajax-loader" style="display:none;"> <img src="images/load (1).gif" class="img-responsive" style="    width: 50px;"> </div>
    <header class="header dashboard-header">
        <div class="left-zone">
            <div class="dash-logo">
                <a href="https://puno.finance/">
                    <img src="images/logo.png">
                </a>
            </div>
        </div>
        <div class="right-zone">
            <button type="button" class="btn btn-green  py-1" id="unlock" style="    padding: 0 20px;margin: 0 25px 0 0;line-height: 0px; height: 40px; display: none;">Connect</button>
            <div class="header-out">
                <a href="#" id="logOutBtn" onclick="logout()"><i class="fas fa-sign-out-alt"></i>Logout</a>
                <!--<a href="javascript:;" class="menu-side" style="display: none"><i class="fas fa-bars"></i></a>-->
                <div id="toggle" style="display:none;">
                    <div class="one bar"></div>
                    <div class="two bar"></div>
                    <div class="three bar"></div>
                </div>
            </div>
        </div>
        <!--onclick = "withdrawdisplay()"-->
    </header>
    <nav id="side-nav">
        <div class="nav-list">
            <ul class="nav nav-pills nav-stacked col-sm-12 nav_left_tab col-md-12">
                <li class="active"><a href="#tab_a" data-toggle="pill" class="nav-link active" onclick="puno_details()"><i
                     class="fas fa-tachometer-alt"></i>
                  <span>Dashboard</span></a>
                </li>
                <li class=""><a href="#tab_b" data-toggle="pill" class="nav-link" onclick=bal_show()><i
                     class="far fa-credit-card"></i>
                  <span>Buy Puno</span></a>
                </li>
                <li class=""><a href="#tab_c" data-toggle="pill" class="nav-link" onclick=getQr()><i
                     class="fas fa-folder-plus"></i>
                  <span>Deposit</span></a>
                </li>
                <li class=""><a href="#tab_d" data-toggle="pill" class="nav-link"><i class="fas fa-folder-plus"></i>
                  <span>Withdrawal</span></a>
                </li>
                <li class=""><a href="#tab_e" data-toggle="pill" class="nav-link" onclick=transaction_history()><i
                     class="fas fa-history"></i>
                  <span>Transaction History</span></a>
                </li>
                <li class="" id="referral_details_box" style="display: none;"><a href="#tab_f" data-toggle="pill" class="nav-link" onclick=referral_details()><i class="fas fa-bullhorn"></i>
                  <span>Referral Details</span></a>
                </li>
                <li class="" id="setting_box" style="display: none;"><a href="#tab_g" data-toggle="pill" onclick=callFun() class="nav-link"><i class="fas fa-cog"></i>
                  <span>Settings</span></a>
                </li>
            </ul>
        </div>
    </nav>
    <div id="contentbox">
        <div class="tab-content">
            <div class="tab-pane active" id="tab_a">
                <!-- dashboard-area -->
                <div class="dashboard-head">
                    <h4>Dashboard</h4>
                </div>
                <div class="puno-wallet-box">
                    <div class="row">
                        <div class="col-md-4">
                            <article>
                                <figure>
                                    <i class="fa fa-lock"></i>
                                </figure>
                                <figcaption>
                                    <h4>Locked Puno Balance</h4>
                                    <p id="puno_bal" class="d-Inline">00.00</p><span style="margin-left: 5px;font-size: 13px;">PUNO</span>
                                </figcaption>
                            </article>
                        </div>
                        <div class="col-md-4">
                            <article>
                                <figure>
                                    <i class="fas fa-wallet"></i>
                                </figure>
                                <figcaption>
                                    <h4>Tron Balance</h4>
                                    <p id="bal" class="d-Inline">00.00</p><span style="margin-left: 5px;font-size: 13px;">TRX</span>
                                </figcaption>
                            </article>
                        </div>
                        <div class="col-md-4" id="referral_walletbal" style="display: none;">
                            <article>
                                <figure>
                                    <i class="fas fa-wallet"></i>
                                </figure>
                                <figcaption>
                                    <h4>Referral Balance</h4>
                                    <p id="ref_bal_dashbox" class="d-Inline">00.00</p><span style="margin-left: 5px;font-size: 13px;">PUNO</span>
                                </figcaption>
                            </article>
                        </div>
                    </div>
                </div>
                <div class="puno-link">
                    <ul class="row">
                        <li class="col-md-4">
                            <article>
                                <label>Wallet Address</label>
                                <div style="display: flex;">
                                    <!--<span id="wallet_address" style = "width:83%; margin-right: 5px;">XXXXXXXXXXXXXXX00000000XXXX</span>-->
                                    <input id="wallet_address" class="input-feild" type="text" style="width:83%; margin-right: 5px;" value="XXXXXXXXXXXXXXX00000000XXXX" disabled>
                                    <button class="btn btn-green" type="button" onclick='copyToClipboard(document.getElementById("wallet_address").value)'><i
                                 class="fas fa-copy"></i> Copy</button>
                                </div>
                            </article>
                        </li>
                        <li class="col-md-4">
                            <div class="puno-wallet-box">
                                <div class="row">
                                    <div class="col-md-12">
                                        <article>
                                            <figure>
                                                <i class="fa fa-wallet"></i>
                                            </figure>
                                            <figcaption>
                                                <h4>Puno Balance</h4>
                                                <div class="d-flex ">
                                                    <p id="wallet_puno_bal" class="d-Inline">00.00</p>
                                                    <span style="    margin-left: 5px;
                                       font-size: 13px;
                                       background: #0000;
                                       line-height: 28px;
                                       height: 0;
                                       padding: 0 6px;
                                       border: 0;">PUNO</span>
                                                </div>

                                            </figcaption>
                                        </article>
                                    </div>
                                </div>
                            </div>

                        </li>
                        <li class="col-md-4" id="ref_link_box" style="display:none;">
                            <article>
                                <label>Sponser/Referral link</label>
                                <div style="display: flex;">
                                    <!--<span id="ref_link" style = "width:83%; margin-right: 5px;">https://balsamiq.cloud/svufnle/pn5wks5/rFA21</span>-->
                                    <input id="ref_link" type="text" class="input-feild" style="width:83%; margin-right: 5px;" value="https://balsamiq.cloud/svufnle/pn5wks5/rFA21" disabled>
                                    <button class="btn btn-green" type="button" onclick='copyToClipboard(document.getElementById("ref_link").value)'><i
                                 class="fas fa-copy"></i> Copy</button>
                                </div>
                            </article>
                        </li>
                    </ul>
                </div>
                <div class="table-site" id="puno_detail">
                    <table id="table_id" class="table table-condensed table-striped table-hover" style="padding: 0 0 30px 0;color: #ffffff !important;border-bottom: 2px solid #3b4166 !important;">
                        <thead>
                            <tr>
                                <th>S.no</th>
                                <th>Investment amount</th>
                                <th>Puno tokens</th>
                                <th>Buy time</th>
                                <th>Unlock time</th>
                            </tr>
                        </thead>

                        <tbody id="puno_hist">

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane" id="tab_b">
                <!-- dashboard-area -->
                <div class="dashboard-head">
                    <h4>Buy Puno</h4>
                </div>
                <div class="puno-wallet-box buy-puno-box">
                    <div class="row">
                        <div class="col-md-7">
                            <article>
                                <figcaption class="p-0">
                                    <h4>Tron Balance</h4>
                                    <p id="token_bal" class="d-Inline">543656.65</p><span style="margin-left: 5px;font-size: 13px;">TRX</span>
                                </figcaption>
                                <figure>
                                    <i class="fas fa-wallet"></i>
                                </figure>
                            </article>
                        </div>
                    </div>
                </div>
                <div class="buy-form mt-4">
                    <form>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group input-site">
                                            <label>Puno Tokens (PUNO)</label>
                                            <input type="number" name="" placeholder="No. of tokens" class="form-control" id="puno_tokens" onchange="chnggFunction1()">
                                            <span id="puno_error" style="color:red"></span>
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group input-site">
                                            <label>Enter your desired amount (TRX)</label>
                                            <input type="number" name="" placeholder="Amount" class="form-control" id="puno_amount" onchange="chnggFunction()">
                                        </div>
                                    </div>

                                    <div class="col-md-12">
                                        <button type="button" class="btn btn-green" onclick="buy()">Buy puno</button>
                                        <p style="margin: 30px 0px 15px;background-color: #272d51;box-shadow: 0 0 25px 0px #ffffff30;padding: 15px 15px;border: 1px solid #ffffff14;">
                                            Note: If you have made any withdrawal or deposit, kindly wait for the tronlink wallet as it is taking time to respond.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="tab-pane" id="tab_c">
                <!-- dashboard-area -->
                <div class="dashboard-head">
                    <h4>Deposit</h4>
                </div>
                <div class="deposit-box">
                    <div class="puno-link">
                        <ul class="row">
                            <li class="col-md-6">
                                <article>
                                    <div class="qr-box mb-4">
                                        <label style="text-align: center;">QR Code</label>
                                        <figure>
                                            <img id="qr_img" src="images/qr.png">
                                        </figure>
                                        <p></p>
                                    </div>
                                    <label>Wallet Address</label>
                                    <div style="display: flex;">
                                        <input id="wallet_address_deposit" type="text" class="input-feild" style="width:83%; margin-right: 5px;" value="sdhfdfdfsdu23748538438gsdfvsdghfvds" disabled>
                                        <button class="btn btn-green" type="button" onclick='copyToClipboard(document.getElementById("wallet_address_deposit").value)'><i
                                    class="fas fa-copy"></i> Copy</button>
                                    </div>
                                </article>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="tab-pane" id="tab_d">
                <!-- dashboard-area -->
                <div class="dashboard-head">
                    <h4>Withdrawal</h4>
                </div>
                <div class="puno-wallet-box">
                    <div class="row">
                        <div class="col-md-4">
                            <article>
                                <figure>
                                    <i class="fa fa-lock"></i>
                                </figure>
                                <figcaption>
                                    <h4>Locked Puno Balance</h4>
                                    <div class="" style="display:flex;">
                                        <p id="puno_bal_wthdrwl">00.00</p>
                                        <span style="margin-left: 5px;font-size: 13px;line-height: 25px;">PUNO</span>
                                    </div>
                                </figcaption>
                            </article>
                        </div>
                        <div class="col-md-4">
                            <article>
                                <figure>
                                    <i class="fas fa-wallet"></i>
                                </figure>
                                <figcaption>
                                    <h4>Tron Balance</h4>
                                    <div class="" style="display:flex;">
                                        <p id="bal_wthdrwl">00.00</p>
                                        <span style="margin-left: 5px;font-size: 13px;line-height: 25px;">TRX</span>
                                    </div>
                                </figcaption>
                            </article>
                        </div>
                        <div class="col-md-4" id="referral_walletbal_wthdrwl" style="display: none;">
                            <article>
                                <figure>
                                    <i class="fas fa-wallet"></i>
                                </figure>
                                <figcaption>
                                    <h4>Referral Balance</h4>
                                    <div class="" style="display:flex;">
                                        <p id="ref_bal_dashbox_wthdrwl">00.00</p>
                                        <span style="margin-left: 5px;font-size: 13px;line-height: 25px;">PUNO</span>
                                    </div>
                                </figcaption>
                            </article>
                        </div>
                    </div>
                </div>
                <div class="puno-link">
                    <ul class="row">
                        <li class="col-md-6">
                            <article>
                                <div class="" style="
                           display: flex;
                           justify-content: space-between;
                           align-items: center;
                           ">
                                    <label>Wallet Address</label>
                                    <!-- <p style="
                              display: flex;
                              justify-content: space-between;
                              align-items: center;
                              margin: 0;
                              ">Puno Bal:<span id="punowalletbal" style="
                              background: #0000;
                              height: auto;
                              padding: 0;
                              margin: 0;
                              border: 0;
                              ">1212</span></p> -->
                                </div>
                                <div style="display: flex;">
                                    <input id="wall_add_wthdrwl" type="text" class="input-feild" style="width:83%; margin-right: 5px;" value="sdhfdfdfsdu23748538438gsdfvsdghfvds" disabled>
                                    <button class="btn btn-green" type="button" onclick='copyToClipboard(document.getElementById("wall_add_wthdrwl").value)'><i
                                 class="fas fa-copy"></i> Copy</button>
                                </div>
                            </article>

                        </li>
                        <li class="col-md-6">
                            <article>
                                <label>Withdrawn Amount</label>
                                <figcaption>
                                    <div class="" style="display:flex;">
                                        <p id="withdarw_amount">00.00</p>
                                        <span style="    margin-left: 5px;
                              font-size: 13px;
                              line-height: 25px;
                              height: 0;
                              border: 0;
                              padding: 0;">PUNO</span>
                                    </div>
                                </figcaption>
                            </article>

                        </li>

                    </ul>
                </div>
                <div class="puno-link">
                    <ul class="row">
                        <li class="col-md-6">
                            <article>
                                <label>Release Amount</label>
                                <figcaption>
                                    <div class="" style="display:flex;">
                                        <p id="release_amount">00.00</p>
                                        <span style="    margin-left: 5px;
                        font-size: 13px;
                        line-height: 25px;
                        height: 0;
                        border: 0;
                        padding: 0;">PUNO</span>
                                    </div>
                                </figcaption>
                            </article>

                        </li>
                        <li class="col-md-6" id="ref_link_box">
                            <article>
                                <label>Transfer Tokens</label>
                                <div style="display: flex;">
                                    <input class="dashboard_field" placeholder="Enter Amount" type="number" id="transferTokens">

                                    <input class="dashboard_field" placeholder="Enter Address" type="text" id="transferAddress">

                                    <button class="btn btn-green btn-size" type="button" onclick="transfer()">Transfer</button>
                                </div>
                                <p id="amount_error" style=" display:none;   color: red;
                         margin-top: 10px;
                         text-align: center;
                         border-radius: 10px;
                         padding: 4px 0;
                         box-shadow: 0 0 0px 1px red;"></p>
                                <p id="address_error" style="  display:none;  color: red;
                          margin-top: 10px;
                          text-align: center;
                          border-radius: 10px;
                          padding: 4px 0;
                          box-shadow: 0 0 0px 1px red;"></p>


                            </article>
                        </li>
                    </ul>
                </div>
                <!--<form >-->
                <div class="row  mt-4">
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group input-site">
                                    <label>Enter Amount :</label>
                                    <div class="input-with-opt">
                                        <input type="text" name="" placeholder="Amount" id="wthdrwl_amt" class="form-control">
                                        <input type="text" name="" placeholder="Enter wallet address" id="wthdrwl_add" class="form-control mt-3">
                                        <span style="display:none;" class="text-danger" id="wall_add_err"></span>
                                        <select id="type_select" onchange="typeSelect()">
                                 <option disabled="" selected="">Select</option>
                                 <option value="puno">Puno Token(PUNO)</option>
                                 <option value="tron">Tron(TRX)</option>
                                 <option id="option_ref" value="referral">Referral Bonus(PUNO)</option>
                              </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <button class="btn btn-green" onclick="withdrawal()">Withdraw</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--</form>-->
            </div>
            <div class="tab-pane" id="tab_e">
                <!-- dashboard-area -->
                <div class="dashboard-head">
                    <h4>Transaction History</h4>
                </div>
                <div class="table-site">
                    <table id="table_id1" class="table table-condensed table-striped table-hover" style="padding: 0 0 30px 0;color: #ffffff !important;border-bottom: 2px solid #3b4166 !important;">
                        <thead>
                            <tr>
                                <th>S.no</th>
                                <th>Type</th>
                                <th>Wallet_Address</th>
                                <th>Receive From</th>
                                <th>Sent to</th>
                                <th>Tron Amount</th>
                                <th>Token Amount</th>
                                <th>Date</th>
                            </tr>
                        </thead>

                        <tbody id="transaction_hist">

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane" id="tab_f">
                <!-- dashboard-area -->
                <div class="dashboard-head">
                    <h4>Referral Details</h4>
                </div>
                <div class="row  mt-4 mb-4">
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group input-site">
                                    <label>Referral Link </label>
                                    <div class="link-copy">
                                        <!--<p class="mb-0" id="referrel_link">Https://puno.com/ramesh Copy</p>-->
                                        <input id="referrel_link" type="text" class="input-feild" style="width:83%; margin-right: 5px;" value="Https://puno.com/ramesh Copy" disabled>
                                        <button class="btn btn-green" type="button" onclick='copyToClipboard(document.getElementById("referrel_link").value)'><i
                                    class="fas fa-copy"></i> Copy</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group input-site">
                                    <label>Referral Balance</label>
                                    <input type="text" name="" value="0" class="form-control" id="ref_bal_refbox" disabled>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="table-site">
                    <table id="table_id2" class="table table-condensed table-striped table-hover" style="padding: 0 0 30px 0;color: #ffffff !important;border-bottom: 2px solid #3b4166 !important;">
                        <thead>
                            <tr>
                                <th>S.no</th>
                                <th>Referral Name</th>
                                <th>Referral Bonus</th>
                                <th>Date</th>

                            </tr>
                        </thead>

                        <tbody id="referral_hist">

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane" id="tab_g">
                <!-- dashboard-area -->
                <div class="dashboard-head">
                    <h4>Settings</h4>
                </div>
                <div class="buy-form mt-4">
                    <!--<form>-->
                    <div class="row">
                        <div class="col-md-7">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group input-site">
                                        <label>Email</label>
                                        <input type="text" id="EmailID" name="" placeholder="Email" class="form-control">
                                        <p style="color:green">verified</p>
                                        <span id="current_pass_error" class="text-danger bold" style="display:none"></span>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group input-site">
                                        <label>UserName</label>
                                        <input type="text" id="username" name="" placeholder="username" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group input-site">
                                        <label>Phone Number</label>
                                        <input type="number" id="phoenNumber" name="" placeholder="Phone Number" class="form-control">
                                        <p id="phone_ver" style="color:green;display:none">verified</p>
                                        <span id="phone_error" class="text-danger bold" style="display:none"></span>
                                        <button class="btn btn-green" id="numchange" style="
                                 margin-top: 8px; display:none " onclick="numChange()">Update Number</button>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group input-site" id="otp_phoneID" style="display: none;">
                                        <label>OTP</label>
                                        <input type="text" id="otp_phone" name="" class="form-control">
                                        <span id="current_pass_error" class="text-danger bold" style="display:none"></span>

                                        <button class="btn btn-green" id="mobilehide" style="
    margin-top: 8px; " onclick="verify(updateNumber)">Verify Number</button>
                                    </div>
                                    <button class="btn btn-green" id="verifyNumber" onclick="verifyNumber()">Get Otp</button>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group input-site">
                                        <label>Current Password</label>
                                        <input type="password" id="current_password" name="" placeholder="Password" class="form-control">
                                        <span id="current_pass_error" class="text-danger bold" style="display:none"></span>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group input-site">
                                        <label>New Password</label>
                                        <input type="password" id="new_password" name="" placeholder="Password" class="form-control">
                                        <span id="update_pass_error" class="text-danger bold" style="display:none"></span>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group input-site">
                                        <label>Confirm New Password</label>
                                        <input type="password" id="confirm_new_password" name="" placeholder="Password" class="form-control">
                                        <span id="confirm_pass_error" class="text-danger bold" style="display:none"></span>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <button class="btn btn-green" onclick="updateProfile()">Update password</button>
                                    <button type="button" onclick="callFun()" style="display:none" id="callfn">Click Me!</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--</form>-->
                </div>
            </div>
        </div>
        <!-- tab content -->
    </div>
</body>
<script src="js/TronWeb.js"></script>
<script type="text/javascript" src="js/owl.carousel.min.js"></script>
<script src="https://kit.fontawesome.com/184e8709aa.js" crossorigin="anonymous"></script>

<link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<script src="https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.4/css/jquery.dataTables.min.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>


<script>
    var refUsername;
    const toggleAnimation = document.getElementById('toggle');
    const sideBar = document.getElementById('side-nav');
    const contentass = document.getElementById('contentbox');

    toggleAnimation.addEventListener('click', () => {
        if (toggleAnimation.classList != 'on') {
            toggleAnimation.classList.add('on')
        } else {
            toggleAnimation.classList.remove('on')
        };
    });

    toggleAnimation.addEventListener('click', () => {
        if (sideBar.classList != 'active') {
            sideBar.classList.add('active')
        } else {
            sideBar.classList.remove('active')
        }
    });

    toggleAnimation.addEventListener('click', () => {
        if (contentass.classList != 'active') {
            contentass.classList.add('active')
        } else {
            contentass.classList.remove('active')
        }
    });
</script>
<script>
    let token_address = "TQtcmoNVv8CkQErCQ13RUEuedhHUCmXELr";
    let ico_address = "TCWLnnNeAF4mbv9xLjGmdCo7ACJakx5eJR";
    let user_id = localStorage.getItem('userid');


    function api(end_point, method, form) {
        var settings = {
            "url": "https://puno.finance:5000/" + end_point,
            "method": method,
            "contentType": "application/json",
            "data": JSON.stringify(form),
            "dataType": 'json',
        };
        return settings;
    }

    async function transfer() {

        let val = document.getElementById("transferTokens").value;
        let address = document.getElementById("transferAddress").value;
        if (val == "") {
            document.getElementById("amount_error").innerHTML = "**Please enter amount";
            document.getElementById("amount_error").style.display = "block";
            return;
        } else {
            document.getElementById("amount_error").innerHTML = "";
            document.getElementById("amount_error").style.display = "none";
        }
        if (address == "") {
            document.getElementById("address_error").innerHTML = "**Please enter address";
            document.getElementById("address_error").style.display = "block";
            return;
        } else {
            document.getElementById("address_error").innerHTML = "";
            document.getElementById("address_error").style.display = "none";
        }

        if (user_id != null) {
            console.log("fg")
            let settings = api(`api/transfer?transferToken=${val}&transferAddress=${address}&id=${user_id}`, 'GET', '');
            $.ajax(settings).done(function(response) {
                console.log(response);
                if (response.success == true) {
                    document.getElementById("transferTokens").value = '';
                    document.getElementById("transferAddress").value = '';
                    swal(response.msg, {
                        button: false,
                        timer: 3000,
                        icon: "success"
                    });
                } else {
                    swal(response.msg, {
                        button: false,
                        timer: 3000,
                        icon: "error"
                    });
                }
            });
        } else {
            let token_instance = await tronWeb.contract().at(token_address);
            let bal = await token_instance.methods.balanceOf(tronWeb.defaultAddress.base58).call() / (10 ** 6);
            if (bal > 0 && bal > val) {
                let transfer = await token_instance.transfer(address, val * 10 ** 6).send();
                if (transfer) {
                    transactionhistory(window.tronWeb.defaultAddress.base58, 'Transfer Puno', 0, val, address, '-');
                    transactionhistory(address, 'Received Puno', 0, val, '-', window.tronWeb.defaultAddress.base58);
                } else {
                    $('.ajax-loader').css("display", "none");
                    swal("Transaction Error.", {
                        button: false,
                        timer: 3000,
                        icon: "error"
                    });
                }

            } else {
                swal("Not enough balance", {
                    button: false,
                    timer: 3000,
                    icon: "error"
                });
            }
        }
    }


    async function show_user_details() {
        let userId = localStorage.getItem('userid');
        if (userId == null) {
            let token_instance = await tronWeb.contract().at(token_address);
            document.getElementById("logOutBtn").innerHTML = "<i class='fas fa-sign-out-alt'></i>Disconnect";
            document.getElementById("unlock").style.display = "block";
            document.getElementById("ref_link").value = "https://puno.finance/signup.html?ref=" + tronWeb.defaultAddress.base58;
            document.getElementById("wallet_address").value = tronWeb.defaultAddress.base58;
            document.getElementById("wall_add_wthdrwl").value = tronWeb.defaultAddress.base58;
            document.getElementById("unlock").innerHTML = "My Wallet";
            document.getElementById("bal").innerHTML = (await tronWeb.trx.getUnconfirmedBalance(document.getElementById("wallet_address").value)) / 10 ** 6;
            document.getElementById("bal_wthdrwl").innerHTML = (await tronWeb.trx.getUnconfirmedBalance(document.getElementById("wallet_address").value)) / 10 ** 6;
            document.getElementById("wallet_puno_bal").innerHTML = (await token_instance.methods.balanceOf(tronWeb.defaultAddress.base58).call()) / (10 ** 6);
            document.getElementById("token_bal").innerHTML = (await tronWeb.trx.getUnconfirmedBalance(document.getElementById("wallet_address").value)) / 10 ** 6;
        } else if (userId != null) {
            document.getElementById("unlock").style.display = "none";
            document.getElementById("ref_link_box").style.display = "block";
            document.getElementById("setting_box").style.display = "block";
            document.getElementById("referral_details_box").style.display = "block";
            document.getElementById("referral_walletbal").style.display = "block";
            document.getElementById("referral_walletbal_wthdrwl").style.display = "block";
            let settings = api(`api/show_user?user_id=${userId}`, 'GET', '');
            $.ajax(settings).done(function(response) {
                console.log(response)
                if (response.success == true) {
                    refUsername = response.data[0].username;

                    document.getElementById("ref_link").value = "https://puno.finance/signup.html?ref=" + response.data[0].username;
                    document.getElementById("wallet_address").value = response.data[0].wallet_address;
                    document.getElementById("wall_add_wthdrwl").value = response.data[0].wallet_address;
                    document.getElementById("bal").innerHTML = response.bal;
                    document.getElementById("bal_wthdrwl").innerHTML = response.bal;
                    document.getElementById("token_bal").innerHTML = response.bal;
                    document.getElementById("ref_bal_dashbox").innerHTML = response.data[0].referral_bonus;
                    document.getElementById("ref_bal_dashbox_wthdrwl").innerHTML = response.data[0].referral_bonus;
                    document.getElementById("wallet_puno_bal").innerHTML = " " + response.punobal;
                }
            });
        }
    }


    show_user_details();


    setInterval(show_user_details, 3000);
    setInterval(coinBalance, 1000);



    function coinBalance() {
        let wall_add = document.getElementById("wallet_address").value;
        let settings = api(`api/coinbal?wallet_address=${wall_add}`, 'GET', '');
        $.ajax(settings).done(function(response) {
            console.log("fdf", response);
            if (response.success == true) {
                if (response.data > 0) {
                    document.getElementById("puno_bal").innerHTML = (response.data).toFixed(5);
                    document.getElementById("puno_bal_wthdrwl").innerHTML = (response.data).toFixed(5);
                } else {
                    document.getElementById("puno_bal").innerHTML = 0.00000;
                    document.getElementById("puno_bal_wthdrwl").innerHTML = 0.00000;
                }
                document.getElementById("withdarw_amount").innerHTML = (response.data1).toFixed(5);
                document.getElementById("release_amount").innerHTML = response.releaseAmt;
            }
        });
    }

    async function deposit() {
        let user_id = localStorage.getItem('userid');
        if (user_id != null) {
            console.log("user_iduser_iduser_iduser_iduser_iduser_iduser_iduser_id", user_id);
            let settings = api(`api/deposit?user_id=${user_id}`, 'GET', '');
            $.ajax(settings).done(function(response) {
                console.log("responseresponseresponseresponse", response);
                if (response.success == true) {
                    next();
                }
            });
        }
    }

    setInterval(function() {
        deposit();
    }, 17000);

    function getQr() {
        let wall_add = document.getElementById("wallet_address").value;
        document.getElementById("wallet_address_deposit").value = wall_add;
        let qr_src = "https://chart.googleapis.com/chart?chs=250x250&cht=qr&chl=" + wall_add;
        document.getElementById("qr_img").src = qr_src;
    }

    async function transaction_history() {
        $('#table_id1').dataTable().fnDestroy();
        document.getElementById("transaction_hist").innerHTML = '';
        let wall_add, to_wallet;
        if (user_id == null) {
            wall_add = tronWeb.defaultAddress.base58;
        } else {
            wall_add = document.getElementById("wallet_address").value;
        }
        let settings = api(`api/fetchDetails?filter=transactions&data=${wall_add}&item=wallet_address`, 'GET', '');
        $.ajax(settings).done(function(response) {
            console.log("dhhfhhfghh", response);
            if (response.success == true) {
                if (response.data.length != 0) {
                    for (var i = 0; i < response.data.length; i++) {
                        if (response.data[i].to_wallet == null || response.data[i].to_wallet == '' || response.data[i].to_wallet == 'undefined' || response.data[i].to_wallet == 'null' || response.data[i].to_wallet == 0 || response.data[i].fromUser == null || response.data[i].to_wallet == '') {
                            to_wallet = '-';
                            // response.data[i].fromUser = '-';
                        } else {
                            to_wallet = response.data[i].to_wallet;
                            // response.data[i].fromUser = response.data[i].fromUser
                        }
                        if (response.data[i].fromUser == 'null') {
                            response.data[i].fromUser = '-';
                        }
                        console.log("ghj", response.data[i].fromUser);
                        document.getElementById("transaction_hist").innerHTML = document.getElementById("transaction_hist").innerHTML + "<tr><td>" + (i + 1) + "</td><td>" + response.data[i].type + "</td><td>" + response.data[i].wallet_address + "</td><td>" + response.data[i].fromUser + "</td><td>" + to_wallet + "</td><td>" + response.data[i].tron_amount + " " + "TRX" + "</td><td>" + response.data[i].token_amount + " " + "PUNO" + "</td><td>" + new Date(response.data[i].time).toLocaleString(); + "</tr>";
                    }
                } else {
                    document.getElementById("transaction_hist").innerHTML = "<tr><td>No Transaction History</td></tr>"
                }
            } else {
                document.getElementById("transaction_hist").innerHTML = "<tr><td>No Transaction History</td></tr>"
            }
            $('#table_id1').dataTable({
                columnDefs: [{
                    "defaultContent": "-",
                    "targets": "_all"
                }]
            });
        });
    }

    function bal_show() {
        var bal = document.getElementById("bal").innerHTML;
        document.getElementById("token_bal").innerHTML = bal;
    }


    async function buy() {
        let tokens = (document.getElementById("puno_tokens").value);
        if (tokens != '') {
            if (parseInt(tokens) >= 10) {
                if (window.pauseCheck == false) {
                    let pamount = document.getElementById("puno_amount").value;
                    if (pamount != '' && pamount > 0) {
                        let userId = localStorage.getItem('userid');
                        if (userId == null) {
                            let instance = await tronWeb.contract().at(ico_address);
                            let tokenprice = await instance.methods.price().call();
                            let wallet_bal = (await tronWeb.trx.getBalance(document.getElementById("wallet_address").value));
                            console.log(tronWeb.toDecimal(tokenprice._hex));
                            if (wallet_bal > tronWeb.toDecimal(tokenprice._hex) && wallet_bal > (pamount * 10 ** 6)) {
                                await instance.invest().send({
                                    from: window.tronWeb.defaultAddress.base58,
                                    callValue: pamount * 10 ** 6
                                }, async function(err, result) {
                                    if (err) {
                                        swal("Transaction Error", {
                                            buttons: false,
                                            icon: "error",
                                            timer: 3000
                                        });
                                        $('.ajax-loader').css("display", "none");
                                    }
                                    if (result) {
                                        swal("Your transaction is sent, Please wait for confirmation.", {
                                            button: false,
                                            timer: 3000,
                                            icon: "success"
                                        });
                                        //setTimeout(()=>{$('.ajax-loader').css("display", "flex");}, 2000);
                                    }
                                });
                                let events = await tronWeb.getEventResult(ico_address, {
                                    eventName: "Invested",
                                    size: 1
                                })
                                if (events) {
                                    let transaction = await tronWeb.trx.getUnconfirmedTransactionInfo(events[0].transaction);
                                    if (transaction.receipt.result == "SUCCESS") {
                                        transactionhistory(window.tronWeb.defaultAddress.base58, 'Invest', pamount, document.getElementById("puno_tokens").value, '-', '-');

                                    } else {
                                        swal("Transaction Error.", {
                                            button: false,
                                            timer: 3000,
                                            icon: "error"
                                        });
                                        $('.ajax-loader').css("display", "none");
                                    }
                                } else {
                                    swal("Transaction Error.", {
                                        button: false,
                                        timer: 3000,
                                        icon: "error"
                                    });
                                    $('.ajax-loader').css("display", "none");
                                }

                            } else {
                                swal("Not Enough Balance In Your Wallet", {
                                    button: false,
                                    icon: "warning",
                                    timer: 3000
                                });
                            }
                        } else {
                            $('.ajax-loader').css("display", "flex");
                            let form = {
                                user_id: userId,
                                amount: pamount
                            }
                            let settings = api('api/invest', 'POST', form);
                            $.ajax(settings).done(function(response) {
                                console.log(response);
                                $('.ajax-loader').css("display", "none");
                                if (response.success == true) {
                                    document.getElementById("puno_amount").value = '';
                                    document.getElementById("puno_tokens").value = '';
                                    swal(response.msg, {
                                        button: false,
                                        timer: 3000,
                                        icon: "success"
                                    });
                                } else {
                                    swal(response.msg, {
                                        button: false,
                                        timer: 3000,
                                        icon: "error"
                                    });
                                }
                            });
                        }
                    } else {
                        swal("Please enter valid amount", {
                            button: false,
                            icon: "warning",
                            timer: 3000
                        });
                    }
                } else if (window.pauseCheck == true) {
                    swal("Puno sale is paused now! Please try again after sale is live", {
                        button: false,
                        icon: "warning",
                        timer: 3000
                    });
                } else {
                    swal("something went wrong! please try again later", {
                        button: false,
                        icon: "warning",
                        timer: 3000
                    });
                }
            } else {
                swal("Buy atleast 10 PUNO", {
                    button: false,
                    timer: 3000,
                    icon: "warning"
                });

            }
        } else {
            swal("Enter the amount", {
                button: false,
                timer: 3000,
                icon: "warning"
            });
        }
    }
    document.getElementById("puno_amount").addEventListener("keyup", chnggFunction);
    document.getElementById("puno_tokens").addEventListener("keyup", chnggFunction1);

    async function chnggFunction() {
        let amount = document.getElementById("puno_amount").value;
        if (user_id == null) {
            let instance = await tronWeb.contract().at(ico_address);
            let tokenprice = await instance.methods.price().call();
            console.log(tronWeb.toDecimal(tokenprice._hex))
            let tokens = ((amount * 10 ** 12) / (tronWeb.toDecimal(tokenprice._hex)));
            document.getElementById("puno_tokens").value = tokens / 10 ** 6;
            if (parseInt(tokens) >= 10) {
                document.getElementById("puno_error").innerHTML = "";
                console.log("chnggFunction1");
            } else {
                document.getElementById("puno_error").innerHTML = "*Buy Atleast 10 PUNO";
                console.log("chnggFunction12");
            }
        } else {
            let form = {
                type: "TRX",
                amount: amount
            }
            let settings = api('api/chnggFunction', 'POST', form);
            $.ajax(settings).done(function(response) {
                if (response.success == true) {
                    document.getElementById("puno_tokens").value = response.token;
                    let tokens = document.getElementById("puno_tokens").value;
                    if (parseInt(tokens) >= 10) {
                        document.getElementById("puno_error").innerHTML = "";
                        console.log("chnggFunction1");
                    } else {
                        document.getElementById("puno_error").innerHTML = "*Buy Atleast 10 PUNO";
                        console.log("chnggFunction12");
                    }
                }
            });
        }
    }

    async function chnggFunction1() {
        let tokens = (document.getElementById("puno_tokens").value);
        if (user_id == null) {
            let instance = await tronWeb.contract().at(ico_address);
            let tokenprice = await instance.methods.price().call();
            let amount = tokens * tronWeb.toDecimal(tokenprice._hex);
            document.getElementById("puno_amount").value = (amount) / 10 ** 6;

            if (parseInt(tokens) >= 10) {
                document.getElementById("puno_error").innerHTML = "";
                console.log("chnggFunction2");
            } else {
                document.getElementById("puno_error").innerHTML = "*Buy Atleast 10 PUNO";
                console.log("chnggFunction22");
            }
        } else {
            let form = {
                type: "null",
                amount: tokens
            }
            let settings = api('api/chnggFunction', 'POST', form);
            $.ajax(settings).done(function(response) {
                console.log(response)
                if (response.success == true) {
                    document.getElementById("puno_amount").value = response.tron;
                    if (parseInt(tokens) >= 10) {
                        document.getElementById("puno_error").innerHTML = "";
                        console.log("chnggFunction2");
                    } else {
                        document.getElementById("puno_error").innerHTML = "*Buy Atleast 10 PUNO";
                        console.log("chnggFunction22");
                    }
                }
            });
        }
    }

    async function referral_details() {
        $('#table_id2').dataTable().fnDestroy();
        document.getElementById("referral_hist").innerHTML = '';
        let wall_add = document.getElementById("wallet_address").value;
        document.getElementById("referrel_link").value = "https://puno.finance/signup.html?ref=" + refUsername;
        document.getElementById("ref_bal_refbox").value = document.getElementById("ref_bal_dashbox").innerHTML;
        let settings = api(`api/downline?wallet_address=${wall_add}`, 'GET', '');
        $.ajax(settings).done(function(response) {
            console.log("ref", response)
            if (response.success == true) {
                // if (response.data2.length > 0) {
                // console.log("inside")
                // for (var i = 0; i < response.data2.length; i++) {
                //    console.log("ins");
                //    document.getElementById("referral_hist").innerHTML = document.getElementById("referral_hist").innerHTML + "<tr><td>" + (i + 1) + "</td><td>" + response.data2[i].fromUser + "</td><td>" + response.data2[i].token_amount + "</td><td>" + new Date(response.data2[i].time).toLocaleString(); +"</td></tr>";              
                // }
                if (response.data.length > 0) {
                    for (var i = 0; i < response.data.length; i++) {
                        console.log("ins");
                        document.getElementById("referral_hist").innerHTML = document.getElementById("referral_hist").innerHTML + "<tr><td>" + (i + 1) + "</td><td>" + response.data[i].res.username + "</td><td>" + (response.data[i].amt[0].sum).toFixed(1) + " PUNO" + "</td><td>" + new Date(response.data[i].res.created_time).toLocaleString(); + "</td></tr>";
                    }
                }
                // } 
                else {
                    document.getElementById("referral_hist").innerHTML = "<tr><td>No Referral History</td></tr>"
                }

            } else {
                console.log("table2")
                document.getElementById("referral_hist").innerHTML = "<tr><td>No Referral History</td></tr>"
            }

            // $('#table_id2').dataTable();
            $('#table_id2').dataTable({
                columnDefs: [{
                    "defaultContent": "-",
                    "targets": "_all"
                }]
            });
        });
    }

    function logout() {
        // sessionStorage.removeItem('userid');
        localStorage.removeItem('userid');
        setTimeout(function() {
            window.location.href = "https://puno.finance";
        }, 100);
    }

    function updateProfile() {
        let userId = localStorage.getItem('userid');
        let current_password = document.getElementById("current_password").value;
        let new_password = document.getElementById("new_password").value;
        let confirm_new_password = document.getElementById("confirm_new_password").value;

        let passVal = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@#$^!%*?&_])[A-Za-z\d@#$^!%*?&_]{8,}$/;
        let passValTrue = passVal.test(new_password);

        if (current_password == "") {
            document.getElementById('current_pass_error').style.display = "block";
            document.getElementById('current_pass_error').innerHTML = "** Fill this field";
            return;
        } else {
            document.getElementById('current_pass_error').style.display = "none";
            document.getElementById('current_pass_error').innerHTML = "";
        }
        if (passValTrue) {
            document.getElementById('update_pass_error').style.display = "none";
            document.getElementById('update_pass_error').innerHTML = "";
        } else {
            if (new_password == "") {
                document.getElementById('update_pass_error').style.display = "block";
                document.getElementById('update_pass_error').innerHTML = "** Fill this field";
                return;
            } else {
                document.getElementById('update_pass_error').style.display = "block";
                document.getElementById('update_pass_error').innerHTML = "**Password must contain Minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character";
                return;
            }
        }
        if (confirm_new_password == "") {
            document.getElementById('confirm_pass_error').style.display = "block";
            document.getElementById('confirm_pass_error').innerHTML = "** Fill this field";
            return;
        } else {
            document.getElementById('confirm_pass_error').style.display = "none";
            document.getElementById('confirm_pass_error').innerHTML = "";
        }


        let form = {
            userId: userId,
            current_password: current_password,
            new_password: new_password,
            confirm_new_password: confirm_new_password
        }
        let settings = api('api/updateProfile', 'POST', form);
        $.ajax(settings).done(function(response) {
            console.log(response);
            if (response.success == true) {
                swal("Updated Successfully", {
                    button: false,
                    timer: 3000,
                    icon: "success"
                });
                setTimeout(() => {
                    logout()
                }, 3000);


            } else {
                swal(response.msg, {
                    button: false,
                    timer: 3000,
                    icon: "error"
                });
            }
        });
    }

    async function puno_details() {
        $('#table_id').dataTable().fnDestroy();
        document.getElementById("puno_hist").innerHTML = '';
        let user_id = localStorage.getItem('userid');
        if (user_id == null) {
            let instance = await tronWeb.contract().at(ico_address);
            let getdetails = await instance.methods.getUserDetails(tronWeb.defaultAddress.base58).call();
            let getLockTime = await instance.methods.getLockTime().call();
            let get_lock_stamp = (tronWeb.toDecimal((getLockTime._hex))) * 1000
            let length = tronWeb.toDecimal((getdetails[1]._hex));
            if (length != 0) {
                for (let i = 1; i <= length; i++) {
                    let getInvestDetails = await instance.methods.getInvestDetails(tronWeb.defaultAddress.base58, i).call();
                    let puno_hex = getInvestDetails[0]._hex;
                    let invest_hex = getInvestDetails[1]._hex;
                    let buy_stamp = tronWeb.toDecimal((getInvestDetails[2]._hex)) * 1000
                    let unlock_stamp = buy_stamp + get_lock_stamp;
                    document.getElementById("puno_hist").innerHTML = document.getElementById("puno_hist").innerHTML + "<tr><td>" + (i) + "</td><td>" + ((tronWeb.toDecimal(invest_hex)) / 10 ** 6) + " TRX" + "</td><td>" + ((tronWeb.toDecimal(puno_hex)) / 10 ** 6) + " PUNO" + "</td><td>" + new Date(buy_stamp).toLocaleString() + "</td><td>" + new Date(unlock_stamp).toLocaleString() + "</td></tr>";
                }
            } else {
                //  document.getElementById('puno_detail').style.display = "none"
                document.getElementById("puno_hist").innerHTML = document.getElementById("puno_hist").innerHTML + "<tr><td>No Transaction history</td></tr>"
            }
            // $('#table_id').dataTable({ bJQueryUI: true, aaData: data, aoColumns: [{ mData: 'Name' }, { mData: 'Result' }, { mData: 'ExecutionTime' }] });
            $('#table_id').dataTable({
                columnDefs: [{
                    "defaultContent": "-",
                    "targets": "_all"
                }]
            });
        }
        if (user_id != null) {
            // console.log("hello")
            let userId = user_id;
            let form = {
                userId: userId
            }
            let settings = api(`api/investDetails`, 'POST', form);
            $.ajax(settings).done(function(response) {
                if (response.success == true) {
                    if (response.data.length > 0) {
                        puno_show(response.data, response.refPause, response.referralid);
                    } else {
                        document.getElementById("puno_hist").innerHTML = "<tr><td>No history found</td></tr>"
                    }
                } else {
                    document.getElementById("puno_hist").innerHTML = "<tr><td>No history found</td></tr>"
                }
            });
            $('#table_id').dataTable({
                bJQueryUI: true,
                aaData: data,
                aoColumns: [{
                    mData: 'Name'
                }, {
                    mData: 'Result'
                }, {
                    mData: 'ExecutionTime'
                }]
            });
        }

    }

    async function puno_show(instance, ref_pause, referral_id) {
        document.getElementById("puno_hist").innerHTML = "";
        if (ref_pause == 'false') {
            if (referral_id != 0) {
                if (instance.length != 0) {
                    for (let i = 0; i < instance.length; i++) {
                        console.log(instance[i]);
                        document.getElementById("puno_hist").innerHTML = document.getElementById("puno_hist").innerHTML + "<tr><td>" + (i + 1) + "</td><td>" + (instance[i][1] / 10 ** 6) + " TRX" + "</td><td>" + ((instance[i][0] / 10 ** 6)) + " PUNO" + "</td><td>" + new Date(instance[i][2]).toLocaleString() + "</td><td>" + new Date(instance[i][3]).toLocaleString() + "</td></tr>";
                    }
                } else {
                    document.getElementById("puno_hist").innerHTML = "<tr><td>No history found</td></tr>"
                }
            } else {
                if (instance.length != 0) {
                    for (let i = 0; i < instance.length; i++) {
                        document.getElementById("puno_hist").innerHTML = document.getElementById("puno_hist").innerHTML + "<tr><td>" + (i + 1) + "</td><td>" + (instance[i][1] / 10 ** 6) + " TRX" + "</td><td>" + (((instance[i][0]) / 10 ** 6)) + " PUNO" + "</td><td>" + new Date(instance[i][2]).toLocaleString() + "</td><td>" + new Date(instance[i][3]).toLocaleString() + "</td></tr>";
                    }
                } else {
                    document.getElementById("puno_hist").innerHTML = "<tr><td>No history found</td></tr>"
                }
            }
        } else {
            if (instance.length != 0) {
                for (let i = 0; i < instance.length; i++) {
                    document.getElementById("puno_hist").innerHTML = document.getElementById("puno_hist").innerHTML + "<tr><td>" + (i + 1) + "</td><td>" + (instance[i][1] / 10 ** 6) + " TRX" + "</td><td>" + (((instance[i][0]) / 10 ** 6)) + " PUNO" + "</td><td>" + new Date(instance[i][2]).toLocaleString() + "</td><td>" + new Date(instance[i][3]).toLocaleString() + "</td></tr>";
                }
            } else {
                document.getElementById("puno_hist").innerHTML = "<tr><td>No history found</td></tr>"
            }
        }
    }
    puno_details();

    function typeSelect() {
        let change = document.getElementById("type_select").value;
        if (change == "tron" || change == "referral") {
            document.getElementById("wthdrwl_add").style.display = "block";
        } else {
            document.getElementById("wthdrwl_add").style.display = "block";
        }
    }

    function withdrawal() {
        let type = document.getElementById("type_select").value;
        if (type == 'Select') {
            document.getElementById("wall_add_err").style.display = 'block'
            document.getElementById("wall_add_err").innerHTML = "**All fields are required";
            return;
        } else {
            document.getElementById("wall_add_err").style.display = 'none'
            document.getElementById("wall_add_err").innerHTML = "";
        }
        let amount = document.getElementById("wthdrwl_amt").value;
        let self_add = document.getElementById("wall_add_wthdrwl").value;
        let bal;
        let wallet_address;
        if (type == "tron") {
            wallet_address = document.getElementById("wthdrwl_add").value;
            bal = document.getElementById("bal_wthdrwl").innerHTML;
            if (wallet_address == "") {
                document.getElementById("wall_add_err").style.display = 'block'
                document.getElementById("wall_add_err").innerHTML = "**All fields are required";
                return;
            } else {
                document.getElementById("wall_add_err").style.display = 'none'
                document.getElementById("wall_add_err").innerHTML = "";
            }
        } else if (type == "referral") {
            wallet_address = document.getElementById("wthdrwl_add").value;
            bal = document.getElementById("ref_bal_dashbox_wthdrwl").innerHTML;
            if (wallet_address == "") {
                document.getElementById("wall_add_err").style.display = 'block'
                document.getElementById("wall_add_err").innerHTML = "**All fields are required";
                return;
            } else {
                document.getElementById("wall_add_err").style.display = 'none'
                document.getElementById("wall_add_err").innerHTML = "";
            }
        } else {
            wallet_address = document.getElementById("wthdrwl_add").value;
            bal = document.getElementById("release_amount").innerHTML;
            if (wallet_address == "") {
                document.getElementById("wall_add_err").style.display = 'block'
                document.getElementById("wall_add_err").innerHTML = "**All fields are required";
                return;
            } else {
                document.getElementById("wall_add_err").style.display = 'none'
                document.getElementById("wall_add_err").innerHTML = "";
            }
        }
        if (type != null && amount > 0 && amount != null) {
            if (self_add != wallet_address || type == 'puno' || type == 'referral') {
                console.log("bal", bal, "amount", amount);
                if (parseFloat(bal) >= parseFloat(amount)) {
                    if (user_id != null) {
                        $('.ajax-loader').css("display", "flex");
                        let form = {
                            user_id: user_id,
                            amount: amount,
                            wallet_address: wallet_address,
                            type: type
                        }
                        let settings = api('api/withdrawal', 'POST', form);
                        $.ajax(settings).done(function(response) {
                            $('.ajax-loader').css("display", "none");
                            console.log("fsdvsdf", response)
                            if (response.success == true) {

                                document.getElementById("wthdrwl_amt").value = ''
                                document.getElementById("wthdrwl_add").value = ''
                                swal(response.msg, {
                                    button: false,
                                    timer: 3000,
                                    icon: "success"
                                });
                            } else {
                                swal(response.msg, {
                                    button: false,
                                    timer: 3000,
                                    icon: "error"
                                });
                            }
                        });
                    } else if (user_id == null) {
                        if (wallet_address.length == 34) {
                            tronTransfer(amount, wallet_address, type);
                        } else {
                            swal("You entered invalid address", {
                                button: false,
                                timer: 3000,
                                icon: "error"
                            })
                        }
                        // setTimeout(function(){$('.ajax-loader').css("display", "flex");}, 2000);
                    }
                } else {
                    swal("You don't have enough balance", {
                        buttons: false,
                        icon: "error",
                        timer: 3000
                    });
                }
            } else {
                swal("Sender and Receiver wallet address can't be same", {
                    buttons: false,
                    icon: "error",
                    timer: 3000
                });
            }
        } else {
            swal("Please enter valid details", {
                buttons: false,
                icon: "error",
                timer: 3000
            });
        }
    }

    async function tronTransfer(amount, wallet_address, type) {
        if (type == 'tron') {
            let sender_add = tronWeb.defaultAddress.base58;
            let bal = await tronWeb.trx.getBalance(sender_add);
            if (amount > 0 && amount < bal) {
                let send_transaction = await tronWeb.trx.sendTransaction(wallet_address, amount * 10 ** 6);
                if (send_transaction) {
                    // let form = {
                    //    wallet_address: window.tronWeb.defaultAddress.base58,
                    //    type: 'Withdraw TRX',
                    //    tron_amount: amount,
                    //    token_amount: 0,
                    //    to: wallet_address
                    // }


                    transactionhistory(window.tronWeb.defaultAddress.base58, 'Withdraw TRX', amount, 0, wallet_address, '-');
                    transactionhistory(wallet_address, 'Received TRX', amount, 0, '-', window.tronWeb.defaultAddress.base58);
                } else {
                    $('.ajax-loader').css("display", "none");
                    swal("Transaction Error.", {
                        button: false,
                        timer: 3000,
                        icon: "error"
                    });
                }
            } else {
                $('.ajax-loader').css("display", "none");
                swal("Please Enter valid amount.", {
                    button: false,
                    timer: 3000,
                    icon: "error"
                });
            }
        }
        if (type == 'puno') {
            let instance = await tronWeb.contract().at(ico_address);
            await instance.withdrawal(wallet_address, amount * 10 ** 6).send().then(async(result) => {
                let events = await tronWeb.getEventResult(ico_address, {
                    eventName: "Withdraw",
                    size: 1
                })
                if (events != '') {
                    let transaction = await tronWeb.trx.getUnconfirmedTransactionInfo(events[0].transaction);
                    if (transaction.receipt.result == 'SUCCESS') {
                        let form = {
                            wallet_address: window.tronWeb.defaultAddress.base58,
                            type: 'Withdraw PUNO',
                            tron_amount: 0,
                            token_amount: amount
                        }
                        if (window.tronWeb.defaultAddress.base58 != wallet_address) {
                            transactionhistory(window.tronWeb.defaultAddress.base58, 'Withdraw PUNO', 0, amount, wallet_address, '-');
                        } else {
                            transactionhistory(window.tronWeb.defaultAddress.base58, 'Withdraw PUNO', 0, amount, '-', '-');
                        }

                        transactionhistory(wallet_address, 'Received PUNO', 0, amount, '-', window.tronWeb.defaultAddress.base58);
                    } else {
                        swal("Transaction Issue.", {
                            button: false,
                            timer: 3000,
                            icon: "error"
                        });
                    }
                } else {
                    swal("Transaction Errorsssss.", {
                        button: false,
                        timer: 3000,
                        icon: "error"
                    });
                }
            });
        }
    }

    function transactionhistory(address, type, tron, token, to, from) {
        let settings = api(`api/transactionDetails?wallet_address=${address}&type=${type}&tron_amount=${tron}&token_amount=${token}&to=${to}&from= ${from}`, 'GET');

        $.ajax(settings).done(function(response) {
            $('.ajax-loader').css("display", "none");
            if (response.success == true) {
                document.getElementById("wthdrwl_amt").value = '';
                document.getElementById("wthdrwl_add").value = '';
                document.getElementById("puno_amount").value = '';
                document.getElementById("puno_tokens").value = '';
                swal("Transaction Confirm.", {
                    button: false,
                    timer: 3000,
                    icon: "success"
                });
            } else {
                swal("Transaction Error.", {
                    button: false,
                    timer: 3000,
                    icon: "error"
                });
            }
        });
    }

    function copyToClipboard(element) {
        var $temp = $("<input>");
        $("body").append($temp);
        console.log(element);
        $temp.val(element).select();
        document.execCommand("copy");
        swal("Copied", {
            button: false,
            timer: 3000,
            icon: "success"
        });
        $temp.remove();
    }

    function withdrawdisplay() {
        if (user_id != null) {
            document.getElementById("referral_walletbal_wthdrwl").style.display = "block";
        } else if (user_id == null) {
            document.getElementById("option_ref").style.display = "none";
        }
    }
    withdrawdisplay();
    document.getElementById("callfn").click();
</script>

</html>