<!doctype html>
<html>

<head>
   <meta charset="utf-8">
   <title>::.Forgot Password.::</title>
   <link rel="icon" href="images/logo.ico" />
   <!--responsive-meta-here-->
   <meta name="viewport" content="minimum-scale=1.0, maximum-scale=1.0,width=device-width, user-scalable=no">
   <meta name="apple-mobile-web-app-capable" content="yes">
   <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
   <!--responsive-meta-end-->
   <link href="css/bootstrap.min.css" rel="stylesheet" />
   <link href="css/fontawesome.min.css" rel="stylesheet" />
   <link rel="stylesheet" type="text/css" href="css/owl.carousel.min.css" media="screen" />
   <link rel="stylesheet" href="css/style.css" />
   <link rel="stylesheet" href="css/responsive.css">
   <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
   <!-- <link rel="stylesheet" href="css/responsive.css" rel="stylesheet"/> -->
   <!-- <style>
        .forgot-box {
            max-width: 400px;
            margin: 0px auto;
            text-align: center;
            padding: 0px 20px;
        }
        .new-password {
            max-width: 400px;
            margin: 0px auto;
            text-align: center;
            padding: 0px 20px;
        }

      </style> -->
   <style>
      .forgot-box {
         max-width: 400px;
         margin: 0px auto;
         text-align: center;
         padding: 0px 20px;
      }

      .new-password {
         max-width: 400px;
         margin: 0px auto;
         text-align: center;
         padding: 0px 20px;
      }

      .fancy-forms .tab-content {
         background: #161a3000;
         color: #FFFFFF;
         /* padding: 10px; */
      }

      .fancy-forms .nav-tabs .nav-item {
         width: 50%;
         text-align: center;
      }

      .fancy-forms .nav-tabs .nav-link {
         border-color: #151A33;
         color: #fff;
         border-top-left-radius: 0;
         background: #151A33;
         border-top-right-radius: 0;
         box-shadow: 0px 10px 20px 0px rgb(0 0 0 / 30%);
      }

      .fancy-forms .nav-tabs .nav-link.active {
         color: #fff;
         border: 1px solid #272D51;
         background-color: #272D51;
      }

      .fancy-forms .nav-tabs .nav-link:hover {
         border-color: #72747a75;
      }

      fancy-forms .nav-tabs .nav-link.active:hover {
         border-color: #E47A4B;
      }

      .fancyformcontainer {
         background: #272D51;
         padding: 2.5rem 3rem !important;
         margin: 30px 0;
         border-radius: 10px;
      }

      .formsubmitbtn {
         background: #E47A4B;
         color: white;
         margin: 20px 0 0;
      }

      .formsubmitbtn:hover,
      .formsubmitbtn:focus {
         color: #fff;
      }

      .form-control {
         height: 50px;
         border-radius: 10px;
         background-color: #151A33;
         border: 1px solid #72747a75;
      }

      ul#myTab {
         border: 1px solid #ffffff61;
         padding: 15px 10px;
      }

      .forgot-text h6 {
         font-size: 16px;
         text-align: center;
      }
   </style>
</head>
<!-- <body>
      <div class="warper ">
         <div class="login-wraper">
           <div class="login-bg"><img src="images/banner-home.png"></div>
           <div class="forgot-box">
             <div class="logo-in-page">
               <a href="index.html">
                 <img src="images/logo.png" style="width: 170px;margin-bottom: 30px;">
               </a>
               <h4>Forgot Password</h4>
             </div>
             <div class="forgot-box-in" id="emailSender">
               <div class="form-group input-site">
                 <input type="text" id="email" placeholder="Email" class="form-control" value="">
                 <span id="email_error" class="text-danger bold" style="display:none"></span>
               </div>
               <div class="text-center">
                 <button class="btn btn-green w-100" onclick = "forgetPassword()">Send Request</button>
               </div>
             </div>
           </div>
            <div class="new-password mt-4" id="passwordNew" style="display:none;">
              <form method="post">
                 <div class="row">
                    <div class="col-md-12">
                       <div class="row">
                           <div class="col-md-12">
                             <div class="form-group input-site">
                                <input type="text" id="verify_email" name="" placeholder="Enter Email" class="form-control" readonly>
                             </div>
                           </div>
                           <div class="col-md-12">
                             <div class="form-group input-site">
                                <input type="password" name="" id= "password"  placeholder="New Password" class="form-control">
				<span id="pass_error" class="text-danger bold" style="display:none;"></span>
                             </div>
                          </div>
                          <div class="col-md-12">
                             <div class="form-group input-site">
                                <input type="password" name="" id="confirmpassword" placeholder="Confirm New Password" class="form-control">
				<span id="confirmPass_error" class="text-danger bold" style="display:none;"></span>
                             </div>
                          </div>
                          <div class="col-md-12">
                             <div class="form-group input-site">
                                <input type="number" name="" id="vrify-otp"  placeholder="Enter OTP" class="form-control">
				<span id="otp_error" class="text-danger bold" style="display:none;"></span>
                             </div>
                          </div>
                          <div class="col-md-12">
                             <button class="btn btn-green" onclick = "forget_password_verify()">Update password</button>
                          </div>
                       </div>
                    </div>
                 </div>
              </form>
           </div>
         </div>
      </div>
   </body> -->

<body>
   <div class="warper ">
      <div class="login-wraper">
         <div class="login-bg"><img src="images/banner-home.png"></div>
         <div class="forgot-box">
            <div class="logo-in-page">
               <a href="index.html">
                  <img src="images/logo.png" style="width: 170px;margin-bottom: 30px;">
               </a>
               <h4>Forgot Password</h4>
            </div>
         </div>
         <div class="container">
            <div class="row">
               <div class="col-md-8 offset-md-2 mt-0 mb-5 fancy-forms">
                  <!-- <div class="cardbox"> -->
                  <ul class="nav nav-tabs  mt-3" id="myTab" role="tablist">
                     <li class="nav-item">
                        <a class="nav-link active" id="login" data-toggle="tab" href="#login_form" role="tab"
                           aria-controls="login" aria-selected="true" onclick='typeEmail()'>Forgot Password Using Email</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link" id="signup" data-toggle="tab" href="#signup_form" role="tab"
                           aria-controls="signup" aria-selected="false" onclick='typemobile()'>Forgot Password Using Phone</a>
                     </li>
                  </ul>
                  <div class="tab-content" id="myTabContent">
                     <div class="tab-pane fade show active" id="login_form" role="tabpanel" aria-labelledby="login">
                        <div class="fancyformcontainer">
                           <h3 class="text-center pb-3">Forgot Password</h3>
                           <div class="forgot-box-in" id="emailSender">
                              <div class="form-group input-site">
                                 <label>Email</label>
                                 <input type="text" id="email" placeholder="Email"  onkeypress = "enterKeyName(event)"   class="form-control" value="">
                                 <!-- <input type="hidden" class="type" placeholder="phone" class="form-control" value="email"> -->
                                 <span id="email_error" class="text-danger bold" style="display:none"></span>
                              </div>
                              <div class="text-center">
                                 <button class="btn btn-green w-100" onclick="forgetPassword()">Send Request</button>
                              </div>
                           </div>
                           <div class="new-password mt-4" id="passwordNew" style="display:none;">
                              <!--<form method="post">-->
                              <div class="row">
                                 <div class="col-md-12">
                                    <div class="row">
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="text" id="verify_email" name="" placeholder="Enter Email"
                                                class="form-control" readonly>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="password" name="" id="password" placeholder="New Password"
                                                class="form-control">
                                             <span id="pass_error" class="text-danger bold pass_error"
                                                style="display:none;"></span>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="password" name="" id="confirmpassword"
                                                placeholder="Confirm New Password" class="form-control">
                                             <span id="confirmPass_error" class="text-danger bold"
                                                style="display:none;"></span>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="number" name="" id="vrify-otp" placeholder="Enter OTP"
                                                class="form-control">
                                             <span id="otp_error" class="text-danger bold" style="display:none;"></span>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <button class="btn btn-green" onclick="forget_password_verify()">Update
                                             password</button>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <!--</form>-->
                           </div>
                        </div>
                     </div>
                     <div class="tab-pane fade" id="signup_form" role="tabpanel" aria-labelledby="signup">
                        <div class="fancyformcontainer">
                           <h3 class="text-center">Forgot Password</h3>
                           <div class="forgot-box-in" id="passwordSender">
                              <div class="form-group input-site">
                                 <label>Mobile</label>
                                 <input type="number" id="mobile" placeholder="phone" class="form-control" value="">
                                 <!-- <input type="hidden" class="type" placeholder="phone" class="form-control" value="mobile"> -->
                                 <span id="mobile_error" class="text-danger bold" style="display:none"></span>
                              </div>
                              <div class="text-center">
                                 <button class="btn btn-green w-100" onclick="forgetPassword()">Send Request</button>
                              </div>
                           </div>
                           <div class="new-password mt-4" id="mob_passwordNew" style="display:none;">
                              <!--<form method="post">-->
                              <div class="row">
                                 <div class="col-md-12">
                                    <div class="row">
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="text" id="verify_number" name="" placeholder="Enter mobile number"
                                                class="form-control" readonly>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="password" name="" id="mob_password" placeholder="New Password"
                                                class="form-control">
                                             <span id="mob_pass_error" class="text-danger bold"
                                                style="display:none;"></span>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="password" name="" id="mob_confirmpassword"
                                                placeholder="Confirm New Password" class="form-control">
                                             <span id="mob_confirmPass_error" class="text-danger bold"
                                                style="display:none;"></span>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <div class="form-group input-site">
                                             <input type="number" name="" id="mob_vrify-otp" placeholder="Enter OTP"
                                                class="form-control">
                                             <span id="mob_otp_error" class="text-danger bold" style="display:none;"></span>
                                          </div>
                                       </div>
                                       <div class="col-md-12">
                                          <button class="btn btn-green" onclick="forget_password_verify()">Update
                                             password</button>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <!--</form>-->
                           </div>
                        </div>
                     </div>
                  </div>
                  <!--  </div> -->
               </div>
            </div>
         </div>
      </div>
   </div>
</body>
<script src="js/jquery.min.js" type="text/javascript"></script>
<script src="js/bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript" src="js/owl.carousel.min.js"></script>
<script src="https://kit.fontawesome.com/184e8709aa.js" crossorigin="anonymous"></script>
<script type="text/javascript">
   $(window).scroll(function () { var body = $("body"), scroll = $(window).scrollTop(); if (scroll >= 5) body.addClass("fixed"); else body.removeClass("fixed"); });
   window.typecheck = 'email' ;
   function typeEmail(){
      typecheck ='email'
   }
   function typemobile(){
      typecheck ='mobile'
   }
   function enterKeyName(event) {
      if (event.keyCode == 13) {
         console.log("Enter key is pressed");
         forgetPassword();
      } else {}
  }
   function forgetPassword() {
      let type = typecheck;

      if(type == 'email'){
         var dataID = document.getElementById("email").value;
         var dataIDVal = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
         var dataIDTrue = dataIDVal.test(dataID);
      }
      else if(type == 'mobile'){
         var dataID = document.getElementById("mobile").value;
         var dataIDVal = /^[6-9]\d{9}$/
         // var dataIDTrue = dataIDVal.test(dataID);
         var dataIDTrue = true;
      }
      
      if (dataIDTrue) {
         document.getElementById('email_error').style.display = "none";
         document.getElementById('email_error').innerHTML = "";
         document.getElementById('mobile_error').style.display = "none";
         document.getElementById('mobile_error').innerHTML = "";
         var settings = {
            "url": "https://puno.finance:5000/api/forget_password_get_otp",
            "method": "POST",
            "timeout": 0,
            "headers": {
               "Content-Type": "application/x-www-form-urlencoded"
            },
            "data": {
               "email": dataID,
               "type": type
               
            }
         };
         $.ajax(settings).done(function (response) {
            if (response.success == true) {
               swal(response.msg, { button: false, icon: "success", timer: 3000 });
               if(type == 'email'){
                  console.log('insideemail')
                  document.getElementById("verify_email").value = document.getElementById("email").value;
               setTimeout(function () {
                  document.getElementById("passwordNew").style.display = 'block';
                  document.getElementById("emailSender").style.display = 'none';
               }, 2000)
               }
               else if(type == 'mobile'){
                  document.getElementById("verify_number").value = document.getElementById("mobile").value;
               setTimeout(function () {
                  document.getElementById("mob_passwordNew").style.display = 'block';
                  document.getElementById("passwordSender").style.display = 'none';
               }, 2000)
               }
               
            } else {
               swal(response.msg, { button: false, icon: "error", timer: 3000 })
            }
         });
      } else {
         if(type =='email'){
            document.getElementById('email_error').style.display = "block";
         if (dataID == "") document.getElementById('email_error').innerHTML = "** Fill this field";
         else document.getElementById('email_error').innerHTML = "** Email is invalid.";
         }else if(type =='mobile'){
            document.getElementById('mobile_error').style.display = "block";
         if (dataID == "") document.getElementById('mobile_error').innerHTML = "** Fill this field";
         else document.getElementById('mobile_error').innerHTML = "** Mobile number is invalid.";
         }
         
      }
   }

   function forget_password_verify() {
      let type = typecheck;
      
      if(type == 'email'){
         var data = document.getElementById("verify_email").value;
         var data_password = document.getElementById("password").value;
         var data_re_password = document.getElementById("confirmpassword").value;
         var data_otp = document.getElementById("vrify-otp").value;
         var passVal = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@#$^!%*?&_])[A-Za-z\d@#$^!%*?&_]{8,}$/;
         var passValTrue = passVal.test(data_password);
            if (passValTrue) {
            document.getElementById('pass_error').style.display = "none";
            document.getElementById('pass_error').innerHTML = "";
         } else {
            document.getElementById('pass_error').style.display = "block";
            if (data_password == "") document.getElementById('pass_error').innerHTML = "** Fill this field";
            else ddocument.getElementById('pass_error').innerHTML = "**Password must contain Minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character";
            return;
         }
         if (data_re_password == "") {
            document.getElementById('confirmPass_error').style.display = "block";
            document.getElementById('confirmPass_error').innerHTML = "** Fill this field";
            return;
         }
         else {
            document.getElementById('confirmPass_error').style.display = "none";
            document.getElementById('confirmPass_error').innerHTML = "";
         }
         if (data_otp == "") {
            document.getElementById('otp_error').style.display = "block";
            document.getElementById('otp_error').innerHTML = "** Fill this field";
            return;
         }
         else {
            document.getElementById('otp_error').style.display = "none";
            document.getElementById('otp_error').innerHTML = "";
         }
      }
         
      else if(type == 'mobile'){
         var data = document.getElementById("verify_number").value;
         var data_password = document.getElementById("mob_password").value;
         var data_re_password = document.getElementById("mob_confirmpassword").value;
         var data_otp = document.getElementById("mob_vrify-otp").value;
         var passVal = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@#$^!%*?&_])[A-Za-z\d@#$^!%*?&_]{8,}$/;
         var passValTrue = passVal.test(data_password);
            if (passValTrue) {
            document.getElementById('mob_pass_error').style.display = "none";
            document.getElementById('mob_pass_error').innerHTML = "";
         } else {
            document.getElementById('mob_pass_error').style.display = "block";
            if (data_password == "") document.getElementById('mob_pass_error').innerHTML = "** Fill this field";
            else document.getElementById('mob_pass_error').innerHTML = "**Password must contain Minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character";
            return;
         }
         if (data_re_password == "") {
            document.getElementById('mob_confirmPass_error').style.display = "block";
            document.getElementById('mob_confirmPass_error').innerHTML = "** Fill this field";
            return;
         }
         else {
            document.getElementById('mob_confirmPass_error').style.display = "none";
            document.getElementById('mob_confirmPass_error').innerHTML = "";
         }
         if (data_otp == "") {
            document.getElementById('mob_otp_error').style.display = "block";
            document.getElementById('mob_otp_error').innerHTML = "** Fill this field";
            return;
         }
         else {
            document.getElementById('mob_otp_error').style.display = "none";
            document.getElementById('mob_otp_error').innerHTML = "";
         }
      }
    
      console.log(data, data_password,data_re_password,data_otp,type);
      // console.log(email, password, re_password, otp);
      var settings = {
         "url": "https://puno.finance:5000/api/forget_password_verify_otp",
         "method": "POST",
         "timeout": 0,
         "headers": {
            "Content-Type": "application/x-www-form-urlencoded"
         },
         "data": {
            "email": data,
            "password": data_password,
            "re_password": data_re_password,
            "otp": data_otp,
            "type": type,
         }
      };
      $.ajax(settings).done(function (response) {
         if (response.success == true) {
            swal(response.msg, { button: false, icon: "success", timer: 3000 });

            setTimeout(function () {
               window.location.href = "https://puno.finance/login.html";
            }, 5000)
         } else {
            swal(response.msg, { button: false, icon: "error", timer: 3000 })
         }
      });
   }

</script>

</html>
