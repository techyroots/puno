<!doctype html>
<html>
   <head>
      <meta charset="utf-8">
      <title>::.lgoin.::</title>
      <link rel="icon" href="images/logo.ico"  />
      <!--responsive-meta-here-->
      <meta name="viewport" content="minimum-scale=1.0, maximum-scale=1.0,width=device-width, user-scalable=no">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
      <!--responsive-meta-end-->
      <link href="css/bootstrap.min.css" rel="stylesheet" />
      <link href="css/fontawesome.min.css" rel="stylesheet"/>
      <link rel="stylesheet" type="text/css" href="css/owl.carousel.min.css" media="screen" />
      <link rel="stylesheet" href="css/style.css" rel="stylesheet"/>
      <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
      <!-- <link rel="stylesheet" href="css/responsive.css" rel="stylesheet"/> -->
   </head>
   <body>
      <div class="warper ">
         <div class="login-wraper">
           <div class="login-bg"><img src="images/banner-home.png"></div>
           <div class="login-box">
             <div class="logo-in-page">
               <a href="index.html">
                 <img src="images/logo.png">
               </a>
               <h4>Login to your account!</h4>
             </div>
             <div class="login-box-in">
               <div class="form-group input-site">
                 <input type="text" id="email" placeholder="Email" class="form-control">
                 <span id="email_error" class="text-danger bold" style="display:none;"></span>
               </div>
               <div class="form-group input-site">
                 <input type="password" id="pass" placeholder="Password" class="form-control">
                 <span id="pass_error" class="text-danger bold" style="display:none;"></span>
               </div>
               <div class="text-center">
                 <button class="btn btn-green w-100" onclick = "login()">Login</button>
               </div>
               <div class="forgot-text mt-4">
                 <h6>Forget password? <a href="forgot-password.html">Click here!</a></h6>
               </div>
               <div class="forgot-text mt-4">
                 <h6>Don't have an account ? <a href="signup.html">Click here!</a></h6>
               </div>
             </div>
           </div>
         </div>
      </div>
   </body>
   <script src="js/jquery.min.js" type="text/javascript"></script>
   <script src="js/bootstrap.min.js" type="text/javascript"></script>
   <script type="text/javascript" src="js/owl.carousel.min.js"></script>
   <script src="https://kit.fontawesome.com/184e8709aa.js" crossorigin="anonymous"></script>
   <script type="text/javascript">
    $(window).scroll(function(){var body=$("body"),scroll=$(window).scrollTop();if(scroll>=5)body.addClass("fixed");else body.removeClass("fixed");});
    function login()
    {
       
        let email = document.getElementById("email").value;
        let pass = document.getElementById("pass").value;
        console.log(email,pass);
        
        let emailIDVal  = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        let emailIDTrue = emailIDVal.test(email);
        
        if(emailIDTrue){
            document.getElementById('email_error').style.display = "none";
            document.getElementById('email_error').innerHTML = "";
        }else{
            if(email == ""){
                document.getElementById('email_error').style.display = "block";
                document.getElementById('email_error').innerHTML = "** Fill this field";
                return ;
            }
            else{
                document.getElementById('email_error').style.display = "block";
                document.getElementById('email_error').innerHTML = "** Email is invalid.";
                return ;
            } 
           
        }
        
        if(pass == ""){
           document.getElementById('pass_error').style.display = "block";
           document.getElementById('pass_error').innerHTML = "** Fill this field";
           return;
        }
        else{
            document.getElementById('pass_error').innerHTML = "";
            document.getElementById('pass_error').style.display = "none";
        }
        
        var settings = {
          "url": "http://puno.finance:5000/api/login",
          "method": "POST",
          "timeout": 0,
          "headers": {
            "Content-Type": "application/x-www-form-urlencoded"
          },
          "data": {
            "email": email,
            "password": pass
          }
        };
        
        $.ajax(settings).done(function (response) {
          console.log(response);  
	  if(response.success == true)
            {
                swal(response.msg,{
                  timer: 1000,
                  icon: "success",
                  button: false,
                });
                console.log(response.user[0].id);
                if(response.user[0].id == 112){
                   sessionStorage.setItem('userid', response.user[0].id);
                    let userid = sessionStorage.getItem('userid');
                    console.log(userid);
                   setTimeout(function(){   window.location.href = "http://puno.finance/adminDashboard.html";}, 2000);
                }
                else{
                   sessionStorage.setItem('userid', response.user[0].id);
                    let userid = sessionStorage.getItem('userid');
                    console.log(userid); 
		    setTimeout(function(){   window.location.href = "http://puno.finance/dashboard.html";}, 2000);
                }
            }
            else
            {
                swal(response.msg,{
                   timer: 1000,
                  icon: "warning",
                  button: false,
                });
            }
        });
    }
   </script>
</html>
